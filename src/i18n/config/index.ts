/** * ğŸŒ YouTube Analytics Platform ä¼ä¸šçº§å›½é™…åŒ–ä¸»é…ç½® * * åŸºäºç°ä»£ä¸»æµç½‘ç«™optimalå®è·µof4å±‚æ¶æ„è®¾è®¡: * - ğŸ”¥ æ ¸å¿ƒå±‚ (Core): å†…è”åŠ è½½ (<5KB) * - ğŸ“„ é¡µé¢å±‚ (Pages): è·¯ç”±åŠ è½½ (<10KB) * - âš¡ åŠŸèƒ½å±‚ (Features): æ‡’åŠ è½½ (<15KB) * - ğŸ§© Componentså±‚ (Components): ComponentsåŠ è½½ (<5KB) * - ğŸŒ åŠ¨æ€å±‚ (Dynamic): dataåº“å­˜å‚¨ (æ— é™åˆ¶) */ // ä¸´æ—¶å†…è”å®šä¹‰,é¿å…æ¨¡å—å¯¼å…¥é—®é¢˜ const SUPPORTED_LOCALES = { 'en-US': { name: 'English (US)', nativeName: 'English', flag: 'ğŸ‡ºğŸ‡¸', dir: 'ltr', tier: 1, completeness: 100, fallback: null, currency: 'USD', dateFormat: 'MM/DD/YYYY', numberFormat: 'en-US', region: 'Americas', rtl: false }, 'zh-CN': { name: 'Chinese (Simplified)', nativeName: "ç®€ä½“ä¸­æ–‡", flag: 'ğŸ‡¨ğŸ‡³', dir: 'ltr', tier: 1, completeness: 100, fallback: 'en-US', currency: 'CNY', dateFormat: 'YYYY/MM/DD', numberFormat: 'zh-CN', region: 'Asia', rtl: false }, 'ja-JP': { name: 'Japanese', nativeName: "æ—¥æœ¬èª", flag: 'ğŸ‡¯ğŸ‡µ', dir: 'ltr', tier: 2, completeness: 95, fallback: 'en-US', currency: 'JPY', dateFormat: 'YYYY/MM/DD', numberFormat: 'ja-JP', region: 'Asia', rtl: false }, 'ko-KR': { name: 'Korean', nativeName: 'í•œêµ­ì–´', flag: 'ğŸ‡°ğŸ‡·', dir: 'ltr', tier: 2, completeness: 95, fallback: 'en-US', currency: 'KRW', dateFormat: 'YYYY.MM.DD', numberFormat: 'ko-KR', region: 'Asia', rtl: false }, 'de-DE': { name: 'German', nativeName: 'Deutsch', flag: 'ğŸ‡©ğŸ‡ª', dir: 'ltr', tier: 3, completeness: 90, fallback: 'en-US', currency: 'EUR', dateFormat: 'DD.MM.YYYY', numberFormat: 'de-DE', region: 'Europe', rtl: false }, 'fr-FR': { name: 'French', nativeName: 'FranÃ§ais', flag: 'ğŸ‡«ğŸ‡·', dir: 'ltr', tier: 3, completeness: 90, fallback: 'en-US', currency: 'EUR', dateFormat: 'DD/MM/YYYY', numberFormat: 'fr-FR', region: 'Europe', rtl: false }, 'es-ES': { name: 'Spanish', nativeName: 'EspaÃ±ol', flag: 'ğŸ‡ªğŸ‡¸', dir: 'ltr', tier: 3, completeness: 90, fallback: 'en-US', currency: 'EUR', dateFormat: 'DD/MM/YYYY', numberFormat: 'es-ES', region: 'Europe', rtl: false } } as const; type SupportedLocale = keyof typeof SUPPORTED_LOCALES; const DEFAULT_LOCALE: SupportedLocale = 'en-US'; import { TRANSLATION_NAMESPACES, type NamespaceCategory, type LoadingStrategy } from './namespaces'; import { LOADING_STRATEGIES } from './loading-strategy'; // ğŸ¯ ä¸»é…ç½®æ¥å£ export interface I18nConfig { defaultLocale: SupportedLocale; supportedLocales: typeof SUPPORTED_LOCALES; namespaces: typeof TRANSLATION_NAMESPACES; loadingStrategies: typeof LOADING_STRATEGIES; fallbackChain: Record<SupportedLocale, SupportedLocale[]>; cacheConfig: CacheConfig; performanceConfig: PerformanceConfig; } // ğŸ’¾ ç¼“å­˜é…ç½® export interface CacheConfig { memory: { maxSize: number; ttl: number; }; localStorage: { prefix: string; ttl: number; }; sessionStorage: { prefix: string; ttl: number; }; } // âš¡ æ€§èƒ½é…ç½® export interface PerformanceConfig { maxBundleSize: { core: number; // 5KB pages: number; // 10KB features: number; // 15KB components: number; // 5KB }; loadingTimeout: number; retryAttempts: number; preloadThreshold: number; } // ğŸ”„ å›é€€é“¾é…ç½® const FALLBACK_CHAIN: Record<SupportedLocale, SupportedLocale[]> = { 'en-US': ['en-US'], // è‹±æ–‡æ— éœ€å›é€€ 'zh-CN': ['zh-CN', 'en-US'], // ä¸­æ–‡å›é€€åˆ°è‹±æ–‡ 'ja-JP': ['ja-JP', 'en-US'], // æ—¥æ–‡å›é€€åˆ°è‹±æ–‡ 'ko-KR': ['ko-KR', 'en-US'], // éŸ©æ–‡å›é€€åˆ°è‹±æ–‡ 'de-DE': ['de-DE', 'en-US'], // å¾·æ–‡å›é€€åˆ°è‹±æ–‡ 'fr-FR': ['fr-FR', 'en-US'], // æ³•æ–‡å›é€€åˆ°è‹±æ–‡ 'es-ES': ['es-ES', 'en-US'], // è¥¿æ–‡å›é€€åˆ°è‹±æ–‡ }; // ğŸš€ ä¸»é…ç½®å®ä¾‹ export const I18N_CONFIG: I18nConfig = { defaultLocale: DEFAULT_LOCALE, supportedLocales: SUPPORTED_LOCALES, namespaces: TRANSLATION_NAMESPACES, loadingStrategies: LOADING_STRATEGIES, fallbackChain: FALLBACK_CHAIN, // ğŸ’¾ ç¼“å­˜é…ç½® cacheConfig: { memory: { maxSize: 100, // mostå¤šç¼“å­˜100 itemsç¿»Translated textä»¶ ttl: 30 * 60 * 1000 // 30 minutes }, localStorage: { prefix: 'yt-i18n-', ttl: 24 * 60 * 60 * 1000 // 24 hours }, sessionStorage: { prefix: 'yt-i18n-session-', ttl: 60 * 60 * 1000 // 1 hours } }, // âš¡ æ€§èƒ½é…ç½® performanceConfig: { maxBundleSize: { core: 5 * 1024, // 5KB pages: 10 * 1024, // 10KB features: 15 * 1024, // 15KB components: 5 * 1024 // 5KB }, loadingTimeout: 5000, // 5 secondsè¶…æ—¶ retryAttempts: 3, // é‡è¯•3 times preloadThreshold: 0.8 // 80%æ¦‚ç‡é¢„åŠ è½½ } }; // ğŸ¯ é…ç½®éªŒè¯å‡½æ•° export function validateI18nConfig(config: I18nConfig): boolean { // éªŒè¯é»˜è®¤è¯­è¨€æ˜¯å¦åœ¨æ”¯æŒåˆ—è¡¨ä¸­ if (!(config.defaultLocale in config.supportedLocales)) { console.error(`Default locale ${config.defaultLocale} not in supported locales`); return false; } return true; } // ğŸŒ è¯­è¨€æ£€æµ‹å’Œselect export function detectUserLocale(): SupportedLocale { // 1. æ£€æŸ¥URLå‚æ•° if (typeof window !== 'undefined') { const urlParams = new URLSearchParams(window.location.search); const urlLocale = urlParams.get('locale') as SupportedLocale; if (urlLocale && urlLocale in SUPPORTED_LOCALES) { return urlLocale; } } // 2. æ£€æŸ¥localStorage if (typeof window !== 'undefined') { const savedLocale = localStorage.getItem('yt-locale') as SupportedLocale; if (savedLocale && savedLocale in SUPPORTED_LOCALES) { return savedLocale; } } // 3. æ£€æŸ¥æµè§ˆå™¨è¯­è¨€ if (typeof navigator !== 'undefined') { const browserLocales = navigator.languages || [navigator.language]; for (const browserLocale of browserLocales) { // ç²¾ç¡®åŒ¹é… if (browserLocale in SUPPORTED_LOCALES) { return browserLocale as SupportedLocale; } // è¯­è¨€ä»£ç åŒ¹é… (å¦‚ zh -> zh-CN) const langCode = browserLocale.split('-')[0]; const matchedLocale = Object.keys(SUPPORTED_LOCALES).find( locale => locale.startsWith(langCode) ) as SupportedLocale; if (matchedLocale) { return matchedLocale; } } } // 4. Backé»˜è®¤è¯­è¨€ return DEFAULT_LOCALE; } // ğŸ’¾ Saveç”¨æˆ·è¯­è¨€åå¥½ export function saveUserLocale(locale: SupportedLocale): void { if (typeof window !== 'undefined') { localStorage.setItem('yt-locale', locale); } } // ğŸ”„ è·å–å›é€€é“¾ export function getFallbackChain(locale: SupportedLocale): SupportedLocale[] { return FALLBACK_CHAINlocale || [DEFAULT_LOCALE]; } // ğŸ“¦ è·å–å‘½åç©ºé—´é…ç½® export function getNamespaceConfig(namespace: string) { return TRANSLATION_NAMESPACESnamespace; } // âš¡ è·å–åŠ è½½strategies export function getLoadingStrategy(namespace: string): LoadingStrategy { const config = TRANSLATION_NAMESPACESnamespace; return config ? config.loadingStrategy: 'lazy'; } // å¯¼å‡ºç±»å‹å’Œå¸¸é‡ export type { SupportedLocale, NamespaceCategory, LoadingStrategy }; export { SUPPORTED_LOCALES, DEFAULT_LOCALE, TRANSLATION_NAMESPACES, LOADING_STRATEGIES };